from openai import OpenAI
import streamlit as st
from streamlit import _bottom


st.set_page_config(
   page_title="êµ­ë¬´ì¡°ì •ì‹¤ ê³µê³µì—…ë¬´ìš© ì±—ë´‡",
   page_icon="ğŸ§Š",
   layout="wide",
)

st.markdown(
    """
    <style>
        .reportview-container .markdown-text-container {
            display: flex;
            justify-content: flex-end;
        }
        .block-container {
            padding-top: 4rem;
            padding-bottom: 2rem;
            padding-left: 4rem;
            padding-right: 4rem;
        }
    </style>
    <div class='caption' style='text-align: right;'> ì–‘ì‚°ì‹œ ChatGPT ì—°êµ¬ í•™ìŠµ ë™í˜¸íšŒ ê°œë°œ</div>
    """,
    unsafe_allow_html=True
)

st.title("êµ­ë¬´ì¡°ì •ì‹¤ ê³µê³µì—…ë¬´ìš© ì±—ë´‡(GPT-4o-mini)")
# API í‚¤ ì…ë ¥ì°½ ìƒì„±
api_key = st.text_input("OpenAI API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”:", type="password")

st.warning("**1. ChatGPT í™œìš©ë°©ë²• ë° ì£¼ì˜ì‚¬í•­ ì•ˆë‚´ë¥¼ í™•ì¸ í›„ ì´ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.**\n\n"
           "**2. ê³µê³µì—…ë¬´ìš© ì±—ë´‡ì€ ìµœê·¼ 14ê°œì˜ ëŒ€í™”ë§Œ ê¸°ì–µí•˜ì—¬ ë‹µë³€í•˜ë©°, ë¸Œë¼ìš°ì €ë¥¼ ìƒˆë¡œ ê³ ì¹¨í•˜ë©´ ëŒ€í™” ë‚´ìš©ì´ ì‚­ì œë©ë‹ˆë‹¤.**\n\n")
if api_key:
    client = OpenAI(api_key=api_key)
    if "openai_model" not in st.session_state:
        st.session_state["openai_model"] = "gpt-4o-mini"

    if "messages" not in st.session_state: 
        st.session_state["messages"] = [{"role": "assistant", "content": "ê³µì§ì ì—¬ëŸ¬ë¶„ ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?"}]

        
    if "deleted_messages" not in st.session_state:
        st.session_state.deleted_messages = []

    avatars = {
        "user": "data_image/gok.png",
        "assistant": "data_image/gpt.png"
    }

    # ë©”ì‹œì§€ë¥¼ ìµœëŒ€ 14ê°œë¡œ ì œí•œí•˜ëŠ” í•¨ìˆ˜
    def limit_messages():
        max_messages = 14
        while len(st.session_state.messages) > max_messages:
            deleted_message = st.session_state.messages.pop(0)  # ê°€ì¥ ì˜¤ë˜ëœ ë©”ì‹œì§€ ì‚­ì œ
            st.session_state.deleted_messages.append(deleted_message)  # ì‚­ì œëœ ë©”ì‹œì§€ë¥¼ ì €ì¥


    for message in st.session_state.messages:
        avatar = avatars.get(message["role"], None)
        with st.chat_message(message["role"], avatar=avatar):
            st.markdown(message["content"])

    if prompt := st.chat_input("ê¶ê¸ˆí•œ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"):
        st.session_state.messages.append({"role": "user", "content": prompt})
        with st.chat_message("user", avatar=avatars["user"]):
            st.markdown(prompt)

        with st.chat_message("assistant", avatar=avatars["assistant"]):
            stream = client.chat.completions.create(
                model=st.session_state["openai_model"],
                messages=[
                    {"role": m["role"], "content": m["content"]}
                    for m in st.session_state.messages
                ],
                stream=True,
            )
            response = st.write_stream(stream)
        st.session_state.messages.append({"role": "assistant", "content": response})
        limit_messages()  # ë©”ì‹œì§€ ìˆ˜ ì œí•œ í•¨ìˆ˜ í˜¸ì¶œ

        st.write(f"í˜„ì¬ ë©”ì‹œì§€ ìˆ˜: {len(st.session_state.messages)}")
else:
    st.warning("API í‚¤ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.")

st.markdown(
"""
<style>
    section[data-testid="stSidebar"] {
        width: 470px !important; #ì‚¬ì´ë“œë°” ì—´ì—ˆì„ë•Œ ì°½ í¬ê¸°
    }
</style>
""",
unsafe_allow_html=True,
)
with st.sidebar:

    st.sidebar.title("ğŸ“£ ChatGPT í™œìš©ë°©ë²• ë° ì£¼ì˜ì‚¬í•­ ì•ˆë‚´")
    st.write('<div style="text-align:right;"><strong>< 2023.05. í–‰ì •ì•ˆì „ë¶€ ë°œí–‰ ê¸°ì¤€ ></strong></div>', unsafe_allow_html=True)    
    # ê°„ë‹¨í•œ ìš”ì•½
    
    summary = (
    "ChatGPTê°€ ê³µê³µë¶€ë¬¸ ì—…ë¬´ íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©ë˜ì§€ë§Œ, "
    "**:red[ê±°ì§“ ì •ë³´ ìƒì„±]** ë° **:red[ê°œì¸ì •ë³´ ìœ ì¶œ]** ë“±ì˜ ë¬¸ì œë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆìœ¼ë‹ˆ ì•„ë˜ ë‚´ìš©ì„ ì¤€ìˆ˜í•´ ì£¼ì„¸ìš”.\n"
    )
    st.success(summary, icon=None)

    st.write("**ğŸ“› ë¹„ê³µê°œ ì •ë³´ ë° ê°œì¸ì •ë³´ë¥¼ ì…ë ¥í•˜ì§€ ë§ ê²ƒ**")
    st.write("**ğŸ“› ì¸ê³µì§€ëŠ¥ ë‹µë³€ì„ ì‚¬ì‹¤ì—¬ë¶€ ê²€ì¦ ì—†ì´ ì´ìš©í•˜ì§€ ë§ ê²ƒ**")

    pdf_file_path = "ê³µë¬´ì›ì„ ìœ„í•œ_ì±—GPT í™œìš©ë°©ë²• ë° ì£¼ì˜ì‚¬í•­ ì•ˆë‚´ì„œ.pdf"
    if st.download_button(
        label="ê³µë¬´ì›ì„ ìœ„í•œ ChatGPT í™œìš© ë° ì£¼ì˜ì‚¬í•­ ë‹¤ìš´ë¡œë“œ",
        data=open(pdf_file_path, "rb").read(),  # íŒŒì¼ì„ ì½ì–´ì„œ ë°ì´í„°ë¡œ ì„¤ì •
        file_name="ê³µë¬´ì›ì„ ìœ„í•œ_ì±—GPT í™œìš©ë°©ë²• ë° ì£¼ì˜ì‚¬í•­ ì•ˆë‚´ì„œ.pdf",
        mime="application/pdf"
        ):
        st.success("ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë©ë‹ˆë‹¤.")
        
    st.header("1. ChatGPT ì†Œê°œ")
    st.write("ì±—GPT(ChatGPT)ëŠ” OpenAIç¤¾ì˜ ì´ˆê±°ëŒ€ ì–¸ì–´ëª¨ë¸ì¸ GPT-3.5, GPT-4ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì¸ê³µì§€ëŠ¥ ì±—ë´‡ ì„œë¹„ìŠ¤")
    st.write("ë¬¸ì¥ ë‚´ ì•ì„œ ë“±ì¥í•œ ë‹¨ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë’¤ì— ì–´ë–¤ ë‹¨ì–´ê°€ ë“±ì¥í•´ì•¼ ë¬¸ì¥ì´ ìì—°ìŠ¤ëŸ¬ìš´ì§€ë¥¼ ì˜ˆì¸¡í•˜ì—¬ ëŒ€í™”ì˜ ë§¥ë½ì„ ì´í•´í•˜ê³ , ëŒ€í™”ë¥¼ ê¸°ì–µí•˜ëŠ” ë“± ì‚¬ëŒì²˜ëŸ¼ ì‘ë‹µí•˜ëŠ” ëŠ¥ë ¥ì„ ì§€ë‹˜")

    st.header("2. ChatGPT ê³µê³µê¸°ê´€ í™œìš© ë¶„ì•¼")
    
    st.subheader("ê°€. ì •ë³´íƒìƒ‰ëŠ¥ë ¥ í™œìš©")
    st.write("ìƒˆë¡œìš´ ì½˜í…ì¸  ë°œêµ´ê³¼ ë¬¸ì œ í•´ê²° ë°©ì•ˆì„ ìœ„í•œ ê¸°íš ë° ë³´ê³ ì„œ ì‘ì„±, êµ¬ì²´ì  ì§ˆë¬¸ì„ í†µí•´ ì•„ì´ë””ì–´ë¥¼ ì–»ê³  ë¯¸í™•ì • ì •ì±… ìœ ì¶œì— ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.")
    with st.expander("**âœ”ï¸ ì•„ì´ë””ì–´ íƒìƒ‰ í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. ì €ì¶œì‚° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì •ì±…ì„ ìˆ˜ë¦½í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ëŒë´„, ì‚¬íšŒì  ì¸ì‹, ê³ ìš©, ì •ë¶€ ì§€ì› ë“± ë‹¤ì–‘í•œ ì¸¡ë©´ì—ì„œ ì•„ì´ë””ì–´ë¥¼ ì œì‹œí•´ ì£¼ì„¸ìš”.")
        st.write("2. ì²­ë…„ ì¼ìë¦¬ ì¦ê°€ë¥¼ ìœ„í•œ ì•„ì´ë””ì–´ë¥¼ í•´ì™¸ì‚¬ë¡€ì™€ ë§¤ì¹­í•˜ì—¬ ì•Œë ¤ì£¼ì„¸ìš”. ì§€ì› ê´€ë ¨ ê¸ˆì•¡ê³¼ ê¸°ê°„ ë“± êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ë„ í¬í•¨í•´ ì£¼ì„¸ìš”.")
        st.write("3. ì§€ì—­í™”íë¥¼ ì‹œë¯¼ë“¤ì´ ì˜ í™œìš©í•˜ë„ë¡ í•˜ê¸° ìœ„í•´ ì–‘ì‚°ì‹œëŠ” ì–´ë–¤ ë…¸ë ¥ì„ í•´ì•¼ í• ê¹Œìš”? ")
        st.write("4. í•´ì™¸ì—ì„œ ì¸ê³µì§€ëŠ¥ì„ í™œìš©í•œ í–‰ì • ì„œë¹„ìŠ¤ì— ëŒ€í•´ ì—´ ê°€ì§€ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.")
        st.write("5. í”Œë¼ìŠ¤í‹± ì‹ ë¶„ì¦ì„ ëª¨ë°”ì¼ ì „ìì‹ ë¶„ì¦ìœ¼ë¡œ ì „í™˜í–ˆì„ ë•Œ ì¥ì ê³¼ ë‹¨ì ì€ ë¬´ì—‡ì¼ê¹Œìš”?")

    with st.expander("**âœ”ï¸ êµ­ë‚´ì™¸ ìë£Œì¡°ì‚¬ í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. í•œêµ­ì„ ì œì™¸í•œ ë‚˜ë¼ì—ì„œ ì •ë…„(ì—°ê¸ˆìˆ˜ë ¹ ì—°ë ¹) ì—°ì¥ ì‚¬ë¡€ì™€ ê·¸ì— ê´€ë ¨ëœ ì—°êµ¬ë‚´ìš©ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.")
        st.write("2. ë‚¨ì„±ì˜ ìœ¡ì•„íœ´ì§ì´ ì €ì¶œì‚°ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì— ëŒ€í•´ ì—°êµ¬ëœ ë‚´ìš©ë“¤ì„ ì•Œë ¤ì£¼ì„¸ìš”.")
        st.write("3. ê³µì‹ì  ìë£Œë¥¼ í™œìš©í•˜ì—¬ ì• í”Œì˜ ìŠ¤ë§ˆíŠ¸í° ë§¤ì¶œì•¡ê³¼ ì‚¼ì„±ì „ìì˜ ìŠ¤ë§ˆíŠ¸í° ë§¤ì¶œì•¡ì„ 2019ë…„ 1ë¶„ê¸°ë¶€í„° 2020ë…„ 3ë¶„ê¸°ê¹Œì§€ ë¹„êµí•´ì£¼ì„¸ìš”. í•´ë‹¹ ìë£Œì˜ ì¶œì²˜ë„ ë§í•´ì£¼ì„¸ìš”.")
        st.write("4. ìì—°ì–´  ì²˜ë¦¬  ì¸ê³µì§€ëŠ¥  ì•Œê³ ë¦¬ì¦˜ì—  ëŒ€í•œ  ë…¼ë¬¸ì¸  â€˜Attention  is  all you needâ€™ì— ëŒ€í•´ ë¹„ì „ê³µìë„ ì•Œê¸° ì‰½ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”")

    
    st.subheader("ë‚˜. ì–¸ì–´ëŠ¥ë ¥ í™œìš©")
    st.write("ë³´ë„ìë£Œ, ì¸ì‚¬ë§, ê°•ì˜ ìë£Œ ë“± ëŒ€ì™¸ ê³µê°œ ìë£Œì˜ íš¨ìœ¨ì  ì‘ì„±ì„ ìœ„í•´ ì´ˆì•ˆì´ í•„ìš”í•  ê²½ìš°, ë¯¸í™•ì • ì •ì±…ì´ë‚˜ ë¹„ê³µê°œ ì •ë³´, ê°œì¸ì •ë³´ë¥¼ ì…ë ¥í•  ë•Œ ì •ë³´ ìœ ì¶œì— ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.")
    with st.expander("**âœ”ï¸ ë³´ë„ìë£Œ ë“± ì´ˆì•ˆ ì‘ì„± í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. ì´ˆê±°ëŒ€ AI ê³µê³µë¶€ë¬¸ í™œìš©ë°©ì•ˆ ì„¸ë¯¸ë‚˜ ê°œìµœê³„íšì„ ê¸°ì´ˆë¡œ ë³´ë„ìë£Œë¡œ ë§Œë“¤ë ¤ê³  í•©ë‹ˆë‹¤. ì•„ë˜ ê³„íšì„ ì°¸ê³ í•˜ì—¬ ë³´ë„ìë£Œë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. ì²« ë¬¸ë‹¨ì—ëŠ” í–‰ì‚¬ ê°œìš”ì™€ ëª©ì , ë‘˜ì§¸ ë¬¸ë‹¨ì—ëŠ” ì„¸ë¯¸ë‚˜ ë‚´ìš©, ì…‹ì§¸ ë¬¸ë‹¨ì—ëŠ” ê³µê°œí† ë¡ ì„ í†µí•œ ì„¸ë¯¸ë‚˜ì˜ ê¸°ëŒ€íš¨ê³¼ë¥¼ ë„£ì–´ì„œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
        st.write("2. ì¸ê³µì§€ëŠ¥ì˜ ê³µê³µë¶€ë¬¸ ë„ì…ì„ ì£¼ì œë¡œ í•˜ëŠ” ì„¸ë¯¸ë‚˜ì—ì„œ ì¸ì‚¬ë§ì„ í•´ì•¼ í•˜ëŠ”ë° ì´ˆì•ˆì„ 1,500ì ë‚´ì™¸ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.")
        st.write("3. ì²­ë…„ ì°½ì—… ì§€ì›ì— ëŒ€í•œ ì •ë¶€ì˜ ì •ì±…ì„ ëŒ€í•™ ì¡¸ì—…ìƒë“¤ì—ê²Œ ì‰½ê²Œ ì„¤ëª… í•˜ë ¤ í•˜ëŠ”ë° ì–´ë–¤ ë‚´ìš©ê³¼ ìˆœì„œë¡œ ì„¤ëª…í•˜ë©´ ì¢‹ì„ê¹Œìš”?")
    with st.expander("**âœ”ï¸ ì™¸ë¶€ìë£Œ ìš”ì•½ í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. â€˜ìœ¤ì„ì—´ ëŒ€í†µë ¹ì€ 14ì¼ ë””ì§€í„¸í”Œë«í¼ì •ë¶€ ì¶”ì§„ ê³¼ì •ì—ì„œ ì¸ê³µì§€ëŠ¥ (AI)â€§ì†Œí”„íŠ¸ì›¨ì–´ ë¶„ì•¼ ë“± ì „í›„ë°© íš¨ê³¼ê°€ í´ ê²ƒì´ë¼ê³  ë°í˜”ë‹¤...(ìƒëµ)...â€™ ìœ„ ê¸°ì‚¬ë‚´ìš©ì„ 100ì ë‚´ì™¸ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”")
        st.write("2. AI ê¸°ìˆ ì´ ë°œì „í• ìˆ˜ë¡ ì‚¬ì´ë²„ ë²”ì£„ì™€ ì‚¬ìƒí™œ ìœ ì¶œ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§€ê³  ìˆë‹¤. AIëŠ” ì‚¬ëŒì²˜ëŸ¼ ì‹¤ìˆ˜í•˜ì§€ ì•Šê³  ì°¨ë³„ê³¼ í¸ê²¬ ì—†ì´...(ìƒëµ)...â€™ìœ„ ë…¼ë¬¸ì˜ í•µì‹¬ì„ 10ê°€ì§€ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”")
    with st.expander("**âœ”ï¸ ì–¸ì–´ ê°„ ë²ˆì—­ í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. â€˜La  direction  interministÃ©rielle  du  numÃ©rique  (DINUM)  est  en charge de la transformation numÃ©rique de lâ€™Ã‰tat au bÃ©nÃ©fice du citoyen comme de lâ€™agent, ...(ìƒëµ)...â€˜ìœ„ ë¶ˆì–´ ìë£Œë¥¼ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”")
        st.write("2. â€˜ì±—GPTê°€ ê³µë¬´ì›ì˜ ì—…ë¬´í˜ì‹ ì„ ì´ëˆë‹¤ - ì´ˆê±°ëŒ€ ì¸ê³µì§€ëŠ¥ ê³µê³µë¶€ë¬¸ í™œìš©ë°©ì•ˆ ì„¸ë¯¸ë‚˜ ê°œìµœ ...(ìƒëµ)...â€™ ìœ„ ë³´ë„ìë£Œë¥¼ ë¯¸êµ­ ì–¸ë¡ ë³´ë„ ìŠ¤íƒ€ì¼ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”.")


    st.subheader("ë‹¤. ì»´í“¨í„°ëŠ¥ë ¥ í™œìš©")
    with st.expander("**âœ”ï¸ ì—…ë¬´ìš© ì‘ìš©í”„ë¡œê·¸ë¨ ì‚¬ìš©ë²• íƒìƒ‰ í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. ì—‘ì…€ í‘œì— ì…ë ¥ëœ ê°’ë“¤ ì¤‘ 50ì„ ë„˜ëŠ” ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ í‘œì‹œí•´ì£¼ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.")
        st.write("2. 2021ë…„ë¶€í„° 2023ë…„ê¹Œì§€ ì‚¬ì—… ì˜ˆì‚°ì— ëŒ€í•œ ì—°í‰ê·  ì¦ê°€ìœ¨ì„ ì—‘ì…€ë¡œ êµ¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.")
    with st.expander("**âœ”ï¸ ì—…ë¬´ ìë™í™” í”„ë¡œê·¸ë¨ ì œì‘ í”„ë¡¬í”„íŠ¸(ì˜ˆì‹œ)**", expanded=False):
        st.write("1. (ì—‘ì…€ ì·¨í•©) ìë£Œ ì¡°ì‚¬ë¡œ ê¸°ê´€ë“¤ì´ ì œì¶œí•œ ì—‘ì…€íŒŒì¼ë“¤ì„ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ì·¨í•©í•˜ëŠ” ì—‘ì…€ ë§¤í¬ë¡œë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”. -> ì±—GPTëŠ” ì—‘ì…€ ì•ˆì—ì„œ ì‚¬ìš©ë˜ëŠ” í”„ë¡œê·¸ë¨(VBA) ì½”ë“œë¥¼ ìƒì„±")
        st.write("2. (ê¸°ì‚¬ ê²€ìƒ‰â€§ì •ë¦¬) ã…‡ã…‡ã…‡ ë‰´ìŠ¤ì—ì„œ í–‰ì •ì•ˆì „ë¶€ì™€ ê´€ë ¨ëœ ê¸°ì‚¬ë¥¼ ì°¾ì•„ ì œëª©, ë§í¬, ë‚´ìš©ì„ ì •ë¦¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš” -> ì±—GPTëŠ” íŒŒì´ì¬ ë“±ì˜ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¡œ í”„ë¡œê·¸ë¨ ì½”ë“œë¥¼ ìƒì„±")
 

